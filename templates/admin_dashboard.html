{% extends "base.html" %}

{% block content %}
<div class="glass-card">
    <div style="display: flex; gap: 1rem; align-items: center; margin-bottom: 2rem;">
        <h1>Admin Dashboard</h1>
        <div style="display: flex; gap: 1rem;">
            <a href="{{ url_for('admin_inquiries') }}" class="btn btn-secondary">View User Inquiries</a>
            <a href="{{ url_for('admin_trains') }}" class="btn btn-secondary">Manage Trains</a>
            <a href="{{ url_for('admin_buses') }}" class="btn btn-secondary">Manage Buses</a>
            <a href="{{ url_for('admin_cabs') }}" class="btn btn-secondary">Manage Cabs</a>
        </div>
    </div>

    <div style="margin-bottom: 3rem;">
        <h3>Add New Package</h3>
        <form action="{{ url_for('add_package') }}" method="POST"
            style="background: rgba(0,0,0,0.02); padding: 1.5rem; border-radius: 8px;">
            <div class="form-group">
                <label>Package Name</label>
                <input type="text" name="name" class="form-control" required>
            </div>
            <div class="form-group">
                <label>Description</label>
                <textarea name="description" class="form-control" rows="3" required></textarea>
            </div>
            <div style="display: flex; gap: 1rem;">
                <div class="form-group" style="flex: 1;">
                    <label>Price (₹)</label>
                    <input type="number" step="0.01" name="price" class="form-control" required>
                </div>
                <div class="form-group" style="flex: 1;">
                    <label>Duration (e.g. 3 Days)</label>
                    <input type="text" name="duration" class="form-control" required>
                </div>
            </div>
            <div class="form-group">
                <label>Image URL</label>
                <input type="text" name="image_url" class="form-control" placeholder="http://...">
            </div>
            <div class="form-group">
                <label>Hotel Details</label>
                <textarea name="hotel_details" class="form-control" rows="2"
                    placeholder="e.g. 5-Star Luxury Resort with Spa..."></textarea>
            </div>
            <div class="form-group">
                <label>Local Sightseeing</label>
                <textarea name="sightseeing" class="form-control" rows="2"
                    placeholder="e.g. Morning boat ride, Temple tours..."></textarea>
            </div>
            <div class="form-group">
                <label>Popular Places to Visit</label>
                <textarea name="popular_places" class="form-control" rows="2"
                    placeholder="e.g. Marine Drive, Gateway of India..."></textarea>
            </div>
            <div class="form-group">
                <label>Day-by-Day Itinerary</label>
                <textarea name="itinerary" class="form-control" rows="4"
                    placeholder="Day 1 - Arrival and check-in | Day 2 - City tour | Day 3 - Departure"></textarea>
                <small class="text-muted">Separate each day with a pipe (|) symbol</small>
            </div>
            <div class="form-group">
                <label>Hotel Amenities & Facilities</label>
                <textarea name="hotel_amenities" class="form-control" rows="3"
                    placeholder="Free WiFi | Swimming Pool | Spa & Wellness Center | 24/7 Room Service"></textarea>
                <small class="text-muted">Separate each amenity with a pipe (|) symbol</small>
            </div>

            <hr style="margin: 1.5rem 0;">
            <h5>Discounts & Images</h5>

            <div class="form-group">
                <label>Discount Percentage (%)</label>
                <input type="number" name="discount_percentage" class="form-control" min="0" max="100" step="0.1"
                    value="0" placeholder="e.g. 15">
                <small class="text-muted">Enter 0 for no discount</small>
            </div>


            <div class="form-group">
                <label>Image Gallery (multiple URLs)</label>
                <textarea name="images" class="form-control" rows="2"
                    placeholder="image1.jpg | image2.jpg | image3.jpg"></textarea>
                <small class="text-muted">Separate image URLs with a pipe (|) symbol</small>
            </div>

            <button type="submit" class="btn btn-primary">Add Package</button>
        </form>
    </div>

    <h3>Manage Packages</h3>
    <table style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
        <thead>
            <tr style="border-bottom: 2px solid #eee;">
                <th style="text-align: left; padding: 1rem;">ID</th>
                <th style="text-align: left; padding: 1rem;">Name</th>
                <th style="text-align: left; padding: 1rem;">Price</th>
                <th style="text-align: left; padding: 1rem;">Action</th>
            </tr>
        </thead>
        <tbody>
            {% for package in packages %}
            <tr style="border-bottom: 1px solid #eee;">
                <td style="padding: 1rem;">{{ package.id }}</td>
                <td style="padding: 1rem;">{{ package.name }}</td>
                <td style="padding: 1rem;">₹{{ package.price }}</td>
                <td style="padding: 1rem;">
                    <a href="{{ url_for('delete_package', package_id=package.id) }}" class="btn btn-danger"
                        onclick="return confirm('Are you sure?')">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h3 style="margin-top: 3rem;">Customer Bookings</h3>
    <table style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
        <thead>
            <tr style="border-bottom: 2px solid #eee;">
                <th style="text-align: left; padding: 1rem;">ID</th>
                <th style="text-align: left; padding: 1rem;">Customer</th>
                <th style="text-align: left; padding: 1rem;">Package</th>
                <th style="text-align: left; padding: 1rem;">Date</th>
                <th style="text-align: left; padding: 1rem;">Members</th>
                <th style="text-align: left; padding: 1rem;">Total Price</th>
                <th style="text-align: left; padding: 1rem;">Status</th>
                <th style="text-align: left; padding: 1rem;">Action</th>
            </tr>
        </thead>
        <tbody>
            {% for booking in bookings %}
            <tr style="border-bottom: 1px solid #eee;">
                <td style="padding: 1rem;">{{ booking.id }}</td>
                <td style="padding: 1rem;">{{ booking.user.username }}</td>
                <td style="padding: 1rem;">{{ booking.package.name }}</td>
                <td style="padding: 1rem;">{{ booking.booking_date.strftime('%Y-%m-%d') }}</td>
                <td style="padding: 1rem;">{{ booking.num_members }}</td>
                <td style="padding: 1rem;">₹{{ booking.total_price }}</td>
                <td style="padding: 1rem;">
                    <span
                        class="badge {% if booking.status == 'Confirmed' %}badge-success{% else %}badge-warning{% endif %}">
                        {{ booking.status }}
                    </span>
                </td>
                <td style="padding: 1rem;">
                    <a href="{{ url_for('edit_booking', booking_id=booking.id) }}"
                        class="btn btn-primary btn-sm">Edit</a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="8" style="padding: 1rem; text-align: center;">No bookings found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h3 style="margin-top: 3rem;">Train Bookings</h3>
    <table style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
        <thead>
            <tr style="border-bottom: 2px solid #eee;">
                <th style="text-align: left; padding: 1rem;">ID</th>
                <th style="text-align: left; padding: 1rem;">Customer</th>
                <th style="text-align: left; padding: 1rem;">Train</th>
                <th style="text-align: left; padding: 1rem;">Route</th>
                <th style="text-align: left; padding: 1rem;">Date</th>
                <th style="text-align: left; padding: 1rem;">Class</th>
                <th style="text-align: left; padding: 1rem;">Travellers</th>
                <th style="text-align: left; padding: 1rem;">Total Price</th>
                <th style="text-align: left; padding: 1rem;">Status</th>
            </tr>
        </thead>
        <tbody>
            {% for booking in train_bookings %}
            <tr style="border-bottom: 1px solid #eee;">
                <td style="padding: 1rem;">{{ booking.id }}</td>
                <td style="padding: 1rem;">{{ booking.user.username }}</td>
                <td style="padding: 1rem;">{{ booking.train.operator }} ({{ booking.train.train_number }})</td>
                <td style="padding: 1rem;">{{ booking.train.departure_city }} to {{ booking.train.arrival_city }}</td>
                <td style="padding: 1rem;">{{ booking.travel_date.strftime('%Y-%m-%d') }}</td>
                <td style="padding: 1rem;">{{ booking.selected_class }}</td>
                <td style="padding: 1rem;">{{ booking.num_travellers }}</td>
                <td style="padding: 1rem;">₹{{ booking.final_price }}</td>
                <td style="padding: 1rem;">
                    <span class="badge {% if booking.status == 'Confirmed' %}badge-success{% else %}badge-warning{% endif %}">
                        {{ booking.status }}
                    </span>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="9" style="padding: 1rem; text-align: center;">No train bookings found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h3 style="margin-top: 3rem;">Bus Bookings</h3>
    <table style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
        <thead>
            <tr style="border-bottom: 2px solid #eee;">
                <th style="text-align: left; padding: 1rem;">ID</th>
                <th style="text-align: left; padding: 1rem;">Customer</th>
                <th style="text-align: left; padding: 1rem;">Bus</th>
                <th style="text-align: left; padding: 1rem;">Route</th>
                <th style="text-align: left; padding: 1rem;">Date</th>
                <th style="text-align: left; padding: 1rem;">Class</th>
                <th style="text-align: left; padding: 1rem;">Travellers</th>
                <th style="text-align: left; padding: 1rem;">Total Price</th>
                <th style="text-align: left; padding: 1rem;">Status</th>
            </tr>
        </thead>
        <tbody>
            {% for booking in bus_bookings %}
            <tr style="border-bottom: 1px solid #eee;">
                <td style="padding: 1rem;">{{ booking.id }}</td>
                <td style="padding: 1rem;">{{ booking.user.username }}</td>
                <td style="padding: 1rem;">{{ booking.bus.operator }} ({{ booking.bus.bus_number }})</td>
                <td style="padding: 1rem;">{{ booking.bus.departure_city }} to {{ booking.bus.arrival_city }}</td>
                <td style="padding: 1rem;">{{ booking.travel_date.strftime('%Y-%m-%d') }}</td>
                <td style="padding: 1rem;">{{ booking.selected_class }}</td>
                <td style="padding: 1rem;">{{ booking.num_travellers }}</td>
                <td style="padding: 1rem;">₹{{ booking.final_price }}</td>
                <td style="padding: 1rem;">
                    <span class="badge {% if booking.status == 'Confirmed' %}badge-success{% else %}badge-warning{% endif %}">
                        {{ booking.status }}
                    </span>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="9" style="padding: 1rem; text-align: center;">No bus bookings found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h3 style="margin-top: 3rem;">Cab Bookings</h3>
    <table style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
        <thead>
            <tr style="border-bottom: 2px solid #eee;">
                <th style="text-align: left; padding: 1rem;">ID</th>
                <th style="text-align: left; padding: 1rem;">Customer</th>
                <th style="text-align: left; padding: 1rem;">Cab</th>
                <th style="text-align: left; padding: 1rem;">Route</th>
                <th style="text-align: left; padding: 1rem;">Date</th>
                <th style="text-align: left; padding: 1rem;">Type</th>
                <th style="text-align: left; padding: 1rem;">Travellers</th>
                <th style="text-align: left; padding: 1rem;">Total Price</th>
                <th style="text-align: left; padding: 1rem;">Status</th>
            </tr>
        </thead>
        <tbody>
            {% for booking in cab_bookings %}
            <tr style="border-bottom: 1px solid #eee;">
                <td style="padding: 1rem;">{{ booking.id }}</td>
                <td style="padding: 1rem;">{{ booking.user.username }}</td>
                <td style="padding: 1rem;">{{ booking.cab.provider }} ({{ booking.cab.cab_type }})</td>
                <td style="padding: 1rem;">{{ booking.cab.departure_city }} to {{ booking.cab.arrival_city }}</td>
                <td style="padding: 1rem;">{{ booking.travel_date.strftime('%Y-%m-%d') }}</td>
                <td style="padding: 1rem;">{{ booking.selected_class }}</td>
                <td style="padding: 1rem;">{{ booking.num_travellers }}</td>
                <td style="padding: 1rem;">₹{{ booking.final_price }}</td>
                <td style="padding: 1rem;">
                    <span class="badge {% if booking.status == 'Confirmed' %}badge-success{% else %}badge-warning{% endif %}">
                        {{ booking.status }}
                    </span>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="9" style="padding: 1rem; text-align: center;">No cab bookings found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
